{
    "openapi": "3.0.0",
    "title": "FamilyTree API",
    "version": "0.1.0",
    "servers": [
        {
            "url": "{protocol}://localhost:{port}",
            "description": "Local development server",
            "variables": {
                "protocol": {
                    "enum": ["http"],
                    "default": "http"
                },
                "port": {
                    "enum": ["3000"],
                    "default": "3000" 
                }
            }
        }
    ],
    "paths": {
        "/": {
            "get": {
                "summary": "Returns index page",
                "responses": {
                    "200": {
                        "description": "OK: Returns EJS index template",
                        "content": {
                            "html/text": {
                                "schema": {
                                    "type": "string"
                                }
                            }
                        }
                    }
                }
            }
        },
        "/auth/register": {
            "get": {
                "summary": "Returns register page",
                "responses": {
                    "200": {
                        "description": "OK: Returns EJS register template",
                        "content": {
                            "html/text": {
                                "schema": {
                                    "type": "string"
                                }
                            }
                        }
                    }
                }
            },
            "post": {
                "summary": "Creates a user",
                "description": "Redirect to /auth/login if user was created or try again",
                "requestBody": {
                    "description": "Credentials from registration form fields: username, password",
                    "required": true,
                    "content": {
                        "application/json": {
                            "schema": {
                                "$ref": "#/components/schemas/UserCredentials"
                            }
                        },
                        "application/x-www-form-urlencoded": {
                            "schema": {
                                "$ref": "#/components/schemas/UserCredentials"
                            }
                        }
                    }
                },
                "responses": {
                    "201": {
                        "description": "CREATED: User was created. Redirect to login page"
                    },
                    "400": {
                        "description": "BAD REQUEST: Username/password wasn't provided"
                    },
                    "409": {
                        "description": "CONFLICT: User already exists"
                    }
                }
            }
        },
        "/auth/login": {
            "get": {
                "summary": "Returns login page",
                "description": "",
                "responses": {
                    "200": {
                        "description": "OK: Returns EJS login template",
                        "content": {
                            "html/text": {
                                "schema": {
                                    "type": "string"
                                }
                            }
                        }
                    }
                }
            },
            "post": {
                "summary": "Login user",
                "description": "Login and redirect to profile page or try again",
                "requestBody": {
                    "description": "Credentials from login form fields: username, password",
                    "required": true,
                    "content": {
                        "application/json": {
                            "schema": {
                                "$ref": "#/components/schemas/UserCredentials"
                            }
                        },
                        "application/x-www-form-urlencoded": {
                            "schema": {
                                "$ref": "#/components/schemas/UserCredentials"
                            }
                        }
                    }
                },
                "responses": {
                    "200": {
                        "description": "OK: LogIn and redirect to user profile"
                    },
                    "401": {
                        "description": "UNAUTHORIZED: Incorrect username/password"
                    }
                }
            }
        },
        "/auth/logout": {
            "get": {
                "summary": "Logout user",
                "description": "Logout user (destroy session) and redirect to index page",
                "responses": {
                    "200": {
                        "description": "OK: Returns EJS index template",
                        "content": {
                            "html/text": {
                                "schema": {
                                    "type": "string"
                                }
                            }
                        }
                    }
                }
            }
        },
        "/user/profile": {
            "get": {
                "summary": "Returns current user profile page",
                "responses": {
                    "200": {
                        "description": "OK: Returns EJS index template",
                        "content": {
                            "html/text": {
                                "schema": {
                                    "type": "string"
                                }
                            }
                        }
                    }
                }
            }
        },
        "/user/:id": {
            "get": {
                "summary": "Returnsuser profile page by id"
            }
        },
        "/person/create": {
            "get": {
                "summary": "Returns person create page"
            },
            "post": {}
        },
        "/person/:id": {
            "get": {
                "summary": "Returns person page"
            }
        },
        "/person/remove/:id": {
            "delete": {
                "summary": "Removes person"
            }
        },
        "/tree/create": {
            "post": {
                "summary": "Creates family tree"
            }
        },
        "/tree/:id": {
            "get": {
                "summary": "Returns family tree page"
            }
        },
        "/tree/remove/:id": {
            "delete": {
                "summary": "Removes family tree"
            }
        }
    },
    "components": {
        "schemas": {
            "UserCredentials": {
                "type": "object",
                "properties": {
                    "username": {
                        "type": "string"
                    },
                    "password": {
                        "type": "string"
                    }
                },
                "required": ["username", "password"]
            }
        }
    }   
}